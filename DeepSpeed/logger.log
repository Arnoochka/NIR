[2025-03-01 13:13:42,611] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-01 13:13:47,456] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-01 13:13:47,456] [INFO] [runner.py:607:main] cmd = /home/victor/anaconda3/envs/deepspeed/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMV19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py
[2025-03-01 13:13:49,506] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-01 13:13:52,285] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1]}
[2025-03-01 13:13:52,285] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=2, node_rank=0
[2025-03-01 13:13:52,285] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1]})
[2025-03-01 13:13:52,285] [INFO] [launch.py:164:main] dist_world_size=2
[2025-03-01 13:13:52,285] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1
[2025-03-01 13:13:52,286] [INFO] [launch.py:256:main] process 32379 spawned with command: ['/home/victor/anaconda3/envs/deepspeed/bin/python', '-u', 'main.py', '--local_rank=0']
[2025-03-01 13:13:52,289] [INFO] [launch.py:256:main] process 32380 spawned with command: ['/home/victor/anaconda3/envs/deepspeed/bin/python', '-u', 'main.py', '--local_rank=1']
[2025-03-01 13:13:54,439] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-01 13:13:54,492] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-01 13:14:06,462] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-01 13:14:06,556] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-01 13:14:06,558] [INFO] [logging.py:128:log_dist] [Rank -1] quantize_bits = 8 mlp_extra_grouping = False, quantize_groups = 1
[2025-03-01 13:14:06,562] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-01 13:14:06,563] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-01 13:14:06,605] [INFO] [logging.py:128:log_dist] [Rank -1] quantize_bits = 8 mlp_extra_grouping = False, quantize_groups = 1
[2025-03-01 13:14:06,609] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-01 13:14:06,648] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed-Inference config: {'layer_id': 0, 'hidden_size': 1280, 'intermediate_size': 5120, 'heads': 20, 'num_hidden_layers': -1, 'dtype': torch.float32, 'pre_layer_norm': True, 'norm_type': <NormType.LayerNorm: 1>, 'local_rank': -1, 'stochastic_mode': False, 'epsilon': 1e-05, 'mp_size': 2, 'scale_attention': True, 'triangular_masking': True, 'local_attention': False, 'window_size': 1, 'rotary_dim': -1, 'rotate_half': False, 'rotate_every_two': True, 'return_tuple': True, 'mlp_after_attn': True, 'mlp_act_func_type': <ActivationFuncType.GELU: 1>, 'training_mp_size': 1, 'bigscience_bloom': False, 'max_out_tokens': 1024, 'min_out_tokens': 1, 'scale_attn_by_inverse_layer_idx': False, 'enable_qkv_quantization': False, 'use_mup': False, 'return_single_tuple': False, 'set_empty_params': False, 'transposed_mode': False, 'use_triton': False, 'triton_autotune': False, 'num_kv': -1, 'rope_theta': 10000, 'invert_mask': True}
ninja: no work to do.
Time to load transformer_inference op: 0.016371965408325195 seconds
Time to load transformer_inference op: 0.11066293716430664 seconds
------------------------------------------------------
Free memory : 3.139221 (GigaBytes)  
Total memory: 7.919250 (GigaBytes)  
Requested memory: 0.263672 (GigaBytes) 
Setting maximum total tokens (input + output) to 1024 
WorkSpace: 0x7c6034000000 
------------------------------------------------------
[{'generated_text': 'DeepSpeed is a special kind of digital speedometer, a kind of "electronic speedometer". The speedometer is an electronic system using several digital accelerometers and many digital readouts to show the various factors - like the air temperature, wind speed'}]
[2025-03-01 13:14:12,299] [INFO] [launch.py:351:main] Process 32380 exits successfully.
[2025-03-01 13:14:12,300] [INFO] [launch.py:351:main] Process 32379 exits successfully.
